<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <script src="/static/js/vue.js"></script>
    <script src="/static/js/vue-resource.min.js"></script>
</head>
<body>
<div id="app">
    <div class="panel panel-primary">
        <div class="panel-heading">
            <h3 class="panel-title">添加品牌</h3>
        </div>
        <div class="panel-body form-inline">
            <label>ID
                <input type="text" class="form-control" v-model="id">
            </label>

             <label>名称
                <input type="text" class="form-control" v-model="name">
            </label>

             <label>搜索
                <input type="text" v-model="keyword" v-focus="'blue'">
            </label>
             <!--使用绑定机制 如果加小括号可以传参-->
             <input type="button" value="添加" class="btn btn-primary">
        </div>
    </div>
    <table class="table table-bordered table-hover table-striped">
        <thead>
            <tr>
                <td>ID</td>
                <td>车名</td>
                <td>时间</td>
                <td>操作</td>
            </tr>
        </thead>
        <tbody>
            <!--过滤器空格不能丢-->
            <tr v-for="i in list" :key="i.id">
                <td>${i.id}</td>
                <td>${i.name}</td>
                <td>${ i.time}</td>
                <td><a href="" @click.prevent="del(i.id)">删除</a></td>
            </tr>
        </tbody>
    </table>
    <input type="button" value="Send" @click="postInfo">
    <div>${ msg }</div>
</div>

<script>
    // Vue.config.delimiters = ['${', '}'];
    var vm =new Vue({
            delimiters: ['${', '}'],
            el:"#app",
            data:{
                id:null,
                name:null,
                keyword:null,
                msg:"1111",
                list:[{"id":1,"name":"奔驰","time":new Date()}]
            },
            created(){
                this.getInfo()
            },
            methods:{
                getInfo(){
                    console.log("---------->");
                    this.$http.get("http://192.168.159.128:9000/api/v1/car/list").then(function (result) {
                        if (result.body.err_code==0){
                            alert("成功");
                            this.list=result.body.data
                        }
                        else {
                            alert("---err---")
                        }
                    })

                },
                postInfo(){
                    var body={"id":1,"name":"宝马","time":new Date()};
                    this.$http.post("/api/v1/test/",JSON.stringify(body),{emulateJSON:true}).then((result)=>{
                       if(result.body.err_code==0){
                           this.getInfo()
                       }
                       else {
                           alert("-----err----")
                       }
                    })
                },
                del(id){
                    this.$http.delete("/api/v1/test/"+"?id="+id).then((result)=>{
                        if (result.body.err_code==0){
                            alert("---成功----");
                            this.getInfo()
                        }
                        else {
                            alert("---err---")
                        }
                    })
                }

            }
        })
</script>
</body>
</html>